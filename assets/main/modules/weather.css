/* =========================================
   Weather System (高性能天气系统) - v4.0 Fix
   ========================================= */

/* 1. 天气画布容器 */
#weather-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    /* 必须比背景高一点点，但比内容低 */
    /* 假设 .app-background 是 -2，内容是 1，这里设为 -1 */
    z-index: -1; 
    pointer-events: none;
    overflow: hidden;
}

/* 修改前: background-color: rgba(0, 0, 0, 0.3); -> 死灰 */
/* 修改后: 加入一点海蓝色调，模拟大气感 */

#weather-container::after {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    /* 核心修改：使用偏蓝的冷灰色，而不是纯黑 */
    background-color: rgba(60, 70, 80, 0.2); 
    /* 或者试试带点青色的暴风雨感: background-color: rgba(43, 62, 80, 0.25); */
    opacity: 0;
    transition: opacity 1.5s ease;
    pointer-events: none;
    z-index: 0;
}

/* 只有在白天模式 + 阴天类名时，显示遮罩 */
html[data-bs-theme="light"].weather-overcast #weather-container::after {
    opacity: 1;
}

/* 3. Canvas 用于雨雪 */
#weather-canvas {
    position: relative;
    z-index: 1; /* 保证雨雪在遮罩层之上 */
    display: block;
    width: 100%;
    height: 100%;
    opacity: 0;
    transition: opacity 0.5s ease;
}

#weather-canvas.active {
    opacity: 1;
}

/* 4. 晴天光斑特效 */
.sun-spot {
    position: absolute;
    border-radius: 50%;
    filter: blur(80px); 
    opacity: 0.6;
    animation: sunBreath 12s infinite ease-in-out;
    pointer-events: none;
    z-index: 0;
}

/* --- 白天模式 (暖色调 - 橙黄) --- */
html[data-bs-theme="light"] .sun-spot.spot-1 {
    top: -10%; left: -10%;
    width: 60vw; height: 60vw;
    background: radial-gradient(circle, rgba(255, 160, 0, 0.4), transparent 70%);
    animation-duration: 12s;
}

html[data-bs-theme="light"] .sun-spot.spot-2 {
    bottom: 10%; right: -10%;
    width: 50vw; height: 50vw;
    background: radial-gradient(circle, rgba(255, 100, 0, 0.3), transparent 70%);
    animation-delay: 2s;
    animation-duration: 15s;
}

html[data-bs-theme="light"] .sun-spot.spot-3 {
    top: 30%; left: 40%;
    width: 40vw; height: 40vw;
    background: radial-gradient(circle, rgba(255, 220, 100, 0.3), transparent 70%);
    animation-delay: 5s;
    animation-duration: 18s;
}

/* --- 黑夜模式 (冷色调 - 蓝紫) --- */
html[data-bs-theme="dark"] .sun-spot.spot-1 {
    top: -20%; left: -10%;
    width: 70vw; height: 70vw;
    background: radial-gradient(circle, rgba(40, 50, 180, 0.3), transparent 70%);
    animation-duration: 14s;
}

html[data-bs-theme="dark"] .sun-spot.spot-2 {
    bottom: 0%; right: -20%;
    width: 60vw; height: 60vw;
    background: radial-gradient(circle, rgba(80, 30, 160, 0.25), transparent 70%);
    animation-delay: 1s;
}

html[data-bs-theme="dark"] .sun-spot.spot-3 {
    top: 40%; right: 30%;
    width: 40vw; height: 40vw;
    background: radial-gradient(circle, rgba(0, 150, 255, 0.15), transparent 70%);
    animation-delay: 4s;
}

@keyframes sunBreath {
    0%, 100% { transform: scale(1) translate(0, 0); opacity: 0.5; }
    50% { transform: scale(1.1) translate(20px, -20px); opacity: 0.8; }
}
/* =========================================
   UI 视觉优化：修复白天模式卡片不清、发灰的问题
   ========================================= */

/* 1. 针对白天模式 (light) 下的所有玻璃卡片 */
html[data-bs-theme="light"] .glass-card,
html[data-bs-theme="light"] .glass-panel,
html[data-bs-theme="light"] .glass-header,
html[data-bs-theme="light"] .glass-footer {
    /* 增加不透明度：让卡片更白一点，防止背景的灰色透过来太多 */
    background: rgba(255, 255, 255, 0.85) !important;
    
    /* 增加毛玻璃模糊度，让背后的杂色更柔和 */
    backdrop-filter: blur(12px) saturate(180%);
    -webkit-backdrop-filter: blur(12px) saturate(180%);
    
    /* 添加细微的边框，增强轮廓感 */
    border: 1px solid rgba(255, 255, 255, 0.9);
    
    /* ★关键：添加柔和的投影，让卡片和背景分离开 ★ */
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
}

/* 2. 特别处理：当进入“阴雨天模式”时，白天模式的卡片要稍微变暗以平衡视觉 */
html[data-bs-theme="light"].weather-overcast .glass-card,
html[data-bs-theme="light"].weather-overcast .glass-panel,
html[data-bs-theme="light"].weather-overcast .glass-header {
    /* 核心修改：
       原先是 0.95 (极亮)，现在改为 0.75。
       原理：降低白色的不透明度，让底下那层“蓝灰色遮罩”透上来，
       卡片就会自然带上一点灰调，看起来就像被阴天笼罩了一样。
    */
    background: rgba(255, 255, 255, 0.6) !important;
    
    /* 边框也调淡一点，避免出现明显的白边 */
    border: 1px solid rgba(255, 255, 255, 0.6);
    
    /* 稍微加深阴影，保证卡片虽然变暗了，但依然有层次感 */
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
}

/* 额外优化：阴雨天模式下，文字颜色稍微加深，确保在半透明卡片上依然清晰 */
html[data-bs-theme="light"].weather-overcast body {
    color: #2c3e50; /* 深蓝灰字体 */
}

/* 3. 导航栏和侧边栏文字颜色加深，防止对比度不足 */
html[data-bs-theme="light"] .nav-link,
html[data-bs-theme="light"] .dock-item {
    color: #333;
    font-weight: 500; /* 稍微加粗一点 */
}